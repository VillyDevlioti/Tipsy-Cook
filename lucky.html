<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="assets/css/style.css">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tipsy-Cook</title>

    <!-- Javascript -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>


    <!--Stylesheet-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="./assets/css/style.css">

</head>

<body>
    <div class="d-flex justify-content-around flex-wrap">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <div id="module" class="card" style="width: 22rem;">
            <img class="drink card-img-top">
            <div class="card-body">
                <p class="drink card-text"></p>
            </div>
        </div>
        <div class="card" style="width: 22rem;">
            <img class="food card-img-top">
            <div class="card-body">
                <p class="food card-text"></p>
            </div>
        </div>
        <div class="card" style="width: 22rem;">
            <img class="movie card-img-top">
            <div class="card-body">
                <p class="movie card-text"></p>
            </div>
        </div>
    </div>

    <script>

        var queryURL = "https://www.thecocktaildb.com/api/json/v1/1/random.php";

        $.ajax({
            url: queryURL,
            method: "GET"
        }).then(function (response) {
            // console.log(response.drinks[0]);

            $(".drink").attr({
                "src": response.drinks[0].strDrinkThumb,
                "width": 200,

            })

            $(".drink").append($("<p id=\"drink-title\">").text(response.drinks[0].strDrink))
            $(".drink").append($("<p><strong>Ingredients:</strong></p>"))

            var cnt = 1;
            for (key in response.drinks[0]) {
                if (key.indexOf("strIngredient") !== -1) {
                    if (response.drinks[0][key]) {
                        // console.log(key);
                        appendElemToCardDrink(response.drinks[0]["strMeasure" + cnt++] + " " + response.drinks[0][key]);
                    }
                }
            }

            $(".drink").append($("<p>").text(response.drinks[0].strInstructions))

        });

        function appendElemToCardDrink(str) {
            $(".drink").append($("<p>").text(str));
        }
        var queryURL2 = "https://www.themealdb.com/api/json/v1/1/random.php"
        $.ajax({
            url: queryURL2,
            method: "GET"
        }).then(function (response) {
            // console.log(response)
            $(".food").attr({
                "src": response.meals[0].strMealThumb,
                "width": 200,

            })
            var pMeal = $("<p>").addClass("collapse").attr("aria-expanded", false);
            $(".food").append($("<p id=\"food-title\">").text(response.meals[0].strMeal))
            $(".food").append($("<p><strong>Ingredients:</strong></p>"))

            var cnt = 1;
            for (key in response.meals[0]) {
                if (key.indexOf("strIngredient") !== -1) {
                    if (response.meals[0][key]) {
                        // console.log(key);
                        appendElemToCardFood(response.meals[0]["strMeasure" + cnt++] + " " + response.meals[0][key]);
                    }
                }
            }
            var pInstructions = $("<p>").addClass("collapse").attr("aria-expanded", false).attr("id", "collapseExample");
            $(".food").append(pInstructions.text(response.meals[0].strInstructions))
            var a = $("<a id=\"clickCollapse\">").text("Instructions").attr({
                "data-toggle": "collapse",
                "aria-expandedir": "false",
                "aria-controls": "collapseExample",
                "href": "#collapseExample",
                "role": "button"
            }).addClass("collapsed")

            $(".food").append(a);

        })
        function appendElemToCardFood(str) {
            $(".food").append($("<p>").text(str));
        }
        //19 genres array:
        var genresArray = [28,12,16,35,80,99,18,10751,14,36,27,10402,9648,10749,878,10770,53,10752,37]
        var randomGenre = Math.floor(Math.random() * 20);
        var genreLucky = genresArray[randomGenre];
        var ResultPageMovie = Math.floor(Math.random() * 50);
        var queryURL3 = "https://api.themoviedb.org/3/discover/movie?api_key=382e387c6f775bd0c85d17d888409d89&language=en-US&sort_by=popularity.desc&include_adult=false&include_video=false&page=" + ResultPageMovie + "&vote_average.gte=6&with_genres=" + genreLucky;
        $.ajax({
            url: queryURL3,
            method: "GET"
        }).then(function (response) {
            console.log(response);

            $(".movie").attr({
                "src": "https://image.tmdb.org/t/p/w500" + response.results[0].backdrop_path,
                "width": 200,
            })
            $(".movie").append($("<p id=\"movie-title\">").text(response.results[0].title))
            $(".movie").append($("<p><strong>Release Date:</strong></p>"))
            $(".movie").append($("<p>").text(response.results[0].release_date))
            $(".movie").append($("<p><strong>Overview:</strong></p>"))
            $(".movie").append($("<p>").text(response.results[0].overview))

        });

    </script>




</body>

</html>